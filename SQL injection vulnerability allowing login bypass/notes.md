### Lab: SQL injection vulnerability allowing login bypass
#### Level: APPRENTICE
<br>

----

<br>

 ```
 This lab contains an SQL injection vulnerability in the login function.

To solve the lab, perform an SQL injection attack that logs in to the application as the administrator user. 
```

----



* SQL Injection vulnerability: `Login Function.`

* End Goal: `Login as "administrator" user.`


----

### Analysis:

* After opening the URL, click on My Account, and the Login page opens.
* Here, we have two input fields. One is a username, and the other is the password field
* Since we don't know the backend query, let us assume the query ourself
* Query : `SELECT ID FROM users WHERE username='administrator' and password ='supersecurepassword';`

#### Backend Process: 

</br>

* Users Table

</br>


 ID |                    username                    | password | 
| :--: | :----------------------------------------: | :-------: |
|  1   | james |   admin   |
|  2   | tomcat |   tomcat    |
|  3   | root |   root    |
|  4   |  administrator|   supersecurepassword     |
|  5   | kali |   kali   |
|  6   | windows |   root    |


</br>

* Assume that we need to log in as administrator

* The following query runs in the backend
`SELECT ID FROM users WHERE username='administrator' and password ='supersecurepassword';`


 ID |                    username                    | password | 
| :--: | :----------------------------------------: | :-------: |
|  4   | administrator |   supersecurepassword    |
* we will be logged in administrator.


</br>

#### Solution :

</br>

* Since we don't know the administrator's password, we cannot log in to the website.
* Let's check which input Feild is vulnerable to SQL Injection using the single quote.
* login to the application with, `'` as the username and a random password and Login using the `administrator` as the username and password as `'`. Both of these give "Internal server error" as the response.
* Both the fields might be vulnerable to SQL Injection.
* Since we have the vulnerable fields, we can do this challenge using two payloads.

##### 1st Method: Injection in username feild

* Since we have a valid username can use the following payload `administrator'--`
* If we give this payload as the input to the username field and give any random password, the backend query looks like this `SELECT ID FROM users WHERE username='administrator'--' and password ='randompassword';`
* The first single quote in the payload ends the username field, and `--` will comment out the rest of the query, and we will be logged in as the administrator.

</br>

##### 2st Method: Injection in password feild

* Since we have a valid username, we can give that as the username.
* In the password field, we use the following payload `' or 1=1 --`
* If we give this payload as the input to the password field and username as administrator, the backend query looks like this `SELECT ID FROM users WHERE username='administrator' and password ='' or 1=1 --';`
* Here, in this payload, the single quote ends the password field, and the `or 1=1` return true, and `--` will comment out the rest of the query.
* we will be logged in as the administrator.